<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<TITLE>Autodesk DWF Core Library</TITLE>
</HEAD>
<BODY>
<table border="0" cellpadding="0" cellspacing="0" width="100%" height="140">
	<tr>
		<td background="header.png">&nbsp;</td>
	</tr>
</table>
<!--
	<div class="headingImgcontainer"><img class="headingImg" src="header.png" alt="Autodesk DWF Core Library" title="Autodesk DWF Core Library" border="0" hspace="0" vspace="0"></div>
-->
</BODY>
</HTML>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<h1>Aggregate/Aggregate.cpp</h1>This sample shows how to aggregate two or more dwfs (DWFToolkit::DWFPackageReader DWFToolkit::DWFPackageWriter <a class="el" href="class_d_w_f_toolkit_1_1_d_w_f_content_manager.html">DWFToolkit::DWFContentManager</a>).<p>
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//  Copyright (c) 2006 by Autodesk, Inc.</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//  By using this code, you are agreeing to the terms and conditions of</span>
<a name="l00005"></a>00005 <span class="comment">//  the License Agreement included in the documentation for this code.</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">//  AUTODESK MAKES NO WARRANTIES, EXPRESS OR IMPLIED,</span>
<a name="l00008"></a>00008 <span class="comment">//  AS TO THE CORRECTNESS OF THIS CODE OR ANY DERIVATIVE</span>
<a name="l00009"></a>00009 <span class="comment">//  WORKS WHICH INCORPORATE IT.</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//  AUTODESK PROVIDES THE CODE ON AN "AS-IS" BASIS</span>
<a name="l00012"></a>00012 <span class="comment">//  AND EXPLICITLY DISCLAIMS ANY LIABILITY, INCLUDING</span>
<a name="l00013"></a>00013 <span class="comment">//  CONSEQUENTIAL AND INCIDENTAL DAMAGES FOR ERRORS,</span>
<a name="l00014"></a>00014 <span class="comment">//  OMISSIONS, AND OTHER PROBLEMS IN THE CODE.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">//  Use, duplication, or disclosure by the U.S. Government is subject to</span>
<a name="l00017"></a>00017 <span class="comment">//  restrictions set forth in FAR 52.227-19 (Commercial Computer Software</span>
<a name="l00018"></a>00018 <span class="comment">//  Restricted Rights) and DFAR 252.227-7013(c)(1)(ii) (Rights in Technical</span>
<a name="l00019"></a>00019 <span class="comment">//  Data and Computer Software), as applicable.</span>
<a name="l00020"></a>00020 <span class="comment">//</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">//#include &lt;vld.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;set&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/_file_8h.html">dwfcore/File.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/_string_8h.html">dwfcore/String.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/_m_i_m_e_8h.html">dwfcore/MIME.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include "<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/_stream_file_descriptor_8h.html">dwfcore/StreamFileDescriptor.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/_file_input_stream_8h.html">dwfcore/FileInputStream.h</a>"</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="_version_8h.html">dwf/Version.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="package_2_constants_8h.html">dwf/package/Constants.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "<a class="code" href="_manifest_8h.html">dwf/package/Manifest.h</a>"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "<a class="code" href="_content_manager_8h.html">dwf/package/ContentManager.h</a>"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="_d_w_f6_package_writer_8h.html">dwf/package/writer/DWF6PackageWriter.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="_package_reader_8h.html">dwf/package/reader/PackageReader.h</a>"</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">using namespace </span>DWFCore;
<a name="l00040"></a>00040 <span class="keyword">using namespace </span>DWFToolkit;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#define _DO_CRTDBG_MEMORY_LEAK_CHECK_</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#if defined(_DWFCORE_WIN32_SYSTEM) &amp;&amp; defined(_DO_CRTDBG_MEMORY_LEAK_CHECK_)</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;crtdbg.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#endif</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="keywordtype">bool</span> processArgs( <span class="keywordtype">int</span> argc, 
<a name="l00048"></a>00048                   <span class="keywordtype">char</span>* argv[], 
<a name="l00049"></a>00049                   std::vector&lt;DWFString&gt;&amp; oInFiles, 
<a name="l00050"></a>00050                   <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html">DWFString</a>&amp; zOutFile, 
<a name="l00051"></a>00051                   DWFPackageWriter::teMergeContent&amp; eMergeType );
<a name="l00052"></a>00052 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#if defined(_DO_CRTDBG_MEMORY_LEAK_CHECK_) &amp;&amp; defined(_DWFCORE_WIN32_SYSTEM)</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>    <span class="comment">//</span>
<a name="l00060"></a>00060     <span class="comment">// Enable memory leak reporting in Debug mode under Win32.</span>
<a name="l00061"></a>00061     <span class="comment">//</span>
<a name="l00062"></a>00062     <span class="keywordtype">int</span> tmpFlag = _CrtSetDbgFlag( _CRTDBG_REPORT_FLAG );
<a name="l00063"></a>00063     <span class="comment">// Turn on leak-checking bit</span>
<a name="l00064"></a>00064     tmpFlag |= _CRTDBG_LEAK_CHECK_DF;
<a name="l00065"></a>00065     <span class="comment">// Turn off CRT block checking bit</span>
<a name="l00066"></a>00066     tmpFlag &amp;= ~_CRTDBG_CHECK_CRT_DF;
<a name="l00067"></a>00067     <span class="comment">// Set flag to the new value</span>
<a name="l00068"></a>00068     _CrtSetDbgFlag( tmpFlag );
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <span class="comment">// For mem leak debugging... Please do not delete.</span>
<a name="l00071"></a>00071     <span class="comment">/*</span>
<a name="l00072"></a>00072 <span class="comment">    long foo = 1;</span>
<a name="l00073"></a>00073 <span class="comment">    _CrtSetBreakAlloc(foo);</span>
<a name="l00074"></a>00074 <span class="comment">    */</span>
<a name="l00075"></a>00075 <span class="preprocessor">#endif</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span>
<a name="l00077"></a>00077     <span class="keywordflow">if</span> (argc &lt; 3)
<a name="l00078"></a>00078     {
<a name="l00079"></a>00079         wcout &lt;&lt; L<span class="stringliteral">"Usage: "</span> &lt;&lt; argv[0] &lt;&lt; L<span class="stringliteral">"[-o output.dwf] [-m [p|s]] {files to aggregate}.dwf"</span> &lt;&lt; endl;
<a name="l00080"></a>00080         wcout &lt;&lt; <span class="stringliteral">"-o optionally specify output filename. If it is not provided then the name is Aggregated.dwf."</span> &lt;&lt; endl;
<a name="l00081"></a>00081         wcout &lt;&lt; <span class="stringliteral">"-m should be specified to merge the content in the aggregated package. The p implies that in the case of"</span> &lt;&lt; endl;
<a name="l00082"></a>00082         wcout &lt;&lt; <span class="stringliteral">"   conflicts, the primary content element will be kept (default for a merge). If s is specified, then "</span> &lt;&lt; endl;
<a name="l00083"></a>00083         wcout &lt;&lt; <span class="stringliteral">"   the elements being merged into the primary content have priority."</span> &lt;&lt; endl;
<a name="l00084"></a>00084         wcout &lt;&lt; endl;
<a name="l00085"></a>00085         <span class="keywordflow">return</span> 1;
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     <span class="keywordflow">try</span>
<a name="l00090"></a>00090     {
<a name="l00091"></a>00091         std::vector&lt;DWFString&gt;      oInfiles(0);
<a name="l00092"></a>00092         <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html">DWFString</a>                   zOutfile( L<span class="stringliteral">"Aggregated.dwf"</span> );
<a name="l00093"></a>00093         DWFPackageWriter::teMergeContent eMergeType = DWFPackageWriter::eNoMerge;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095         <span class="keywordflow">if</span> (!processArgs(argc, argv, oInfiles, zOutfile, eMergeType))
<a name="l00096"></a>00096         {
<a name="l00097"></a>00097             wcout &lt;&lt; L<span class="stringliteral">"Usage: "</span> &lt;&lt; argv[0] &lt;&lt; L<span class="stringliteral">"[-o output.dwf] [-m [p|s]] {files to aggregate}.dwf"</span> &lt;&lt; endl;
<a name="l00098"></a>00098             wcout &lt;&lt; <span class="stringliteral">"-o optionally specify output filename. If it is not provided then the name is Aggregated.dwf."</span> &lt;&lt; endl;
<a name="l00099"></a>00099             wcout &lt;&lt; <span class="stringliteral">"-m should be specified to merge the content in the aggregated package. The p implies that in the case of"</span> &lt;&lt; endl;
<a name="l00100"></a>00100             wcout &lt;&lt; <span class="stringliteral">"   conflicts, the primary content element will be kept (default for a merge). If s is specified, then "</span> &lt;&lt; endl;
<a name="l00101"></a>00101             wcout &lt;&lt; <span class="stringliteral">"   the elements being merged into the primary content have priority."</span> &lt;&lt; endl;
<a name="l00102"></a>00102             wcout &lt;&lt; endl;
<a name="l00103"></a>00103             <span class="keywordflow">return</span> 1;
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106         <span class="comment">//</span>
<a name="l00107"></a>00107         <span class="comment">//  Create the destination DWF</span>
<a name="l00108"></a>00108         <span class="comment">//</span>
<a name="l00109"></a>00109         <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_file.html">DWFFile</a> oOutfile( zOutfile );
<a name="l00110"></a>00110         <a name="_a60"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f6_package_writer.html">DWF6PackageWriter</a> oWriter( oOutfile );
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         <span class="comment">//  If we are going to aggregate sections from other packages then we need to initialize</span>
<a name="l00113"></a>00113         <span class="comment">//  for aggregation</span>
<a name="l00114"></a>00114         oWriter.initializeForAggregation( eMergeType );
<a name="l00115"></a>00115 
<a name="l00116"></a>00116         <span class="comment">//</span>
<a name="l00117"></a>00117         <span class="comment">//  The source readers are going to be stored in here until the write is complete</span>
<a name="l00118"></a>00118         <span class="comment">//</span>
<a name="l00119"></a>00119         DWFOrderedVector&lt;DWFPackageReader*&gt; oReaders;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         std::vector&lt;DWFString&gt;::iterator iFile = oInfiles.begin();
<a name="l00122"></a>00122         <span class="keywordflow">for</span> (; iFile != oInfiles.end(); ++iFile)
<a name="l00123"></a>00123         {
<a name="l00124"></a>00124             <span class="comment">//</span>
<a name="l00125"></a>00125             <span class="comment">//  Open each source file and grab the sections and contents and add them to the destination</span>
<a name="l00126"></a>00126             <span class="comment">//</span>
<a name="l00127"></a>00127             <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_file.html">DWFFile</a> oInfile( *iFile );
<a name="l00128"></a>00128             <a name="_a61"></a><a class="code" href="class_d_w_f_package_reader.html">DWFPackageReader</a>* pReader = <a class="code" href="ansi_2_core_8h.html#90357f3f367f8d0e864377f9a3a96924">DWFCORE_ALLOC_OBJECT</a>( <a class="code" href="class_d_w_f_package_reader.html">DWFPackageReader</a>( oInfile ) );
<a name="l00129"></a>00129 
<a name="l00130"></a>00130             <span class="comment">//</span>
<a name="l00131"></a>00131             <span class="comment">//  Store the reader for later cleanup</span>
<a name="l00132"></a>00132             <span class="comment">//</span>
<a name="l00133"></a>00133             oReaders.<a name="a62"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_ordered_vector.html#7e857e3f1674b5e2cb98fb90a52a5e42">push_back</a>( pReader );
<a name="l00134"></a>00134 
<a name="l00135"></a>00135             <span class="comment">//</span>
<a name="l00136"></a>00136             <span class="comment">//  Get the manifest</span>
<a name="l00137"></a>00137             <span class="comment">//</span>
<a name="l00138"></a>00138             <a name="_a63"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest.html">DWFManifest</a>&amp; rManifestIn = pReader-&gt;getManifest();
<a name="l00139"></a>00139 
<a name="l00140"></a>00140             <span class="comment">//</span>
<a name="l00141"></a>00141             <span class="comment">//  For each section determine content to get, track the content and copy sections</span>
<a name="l00142"></a>00142             <span class="comment">//</span>
<a name="l00143"></a>00143             <a name="_a64"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest_1_1_section_iterator.html">DWFManifest::SectionIterator</a>* piSections = rManifestIn.<a name="a65"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest.html#678406f55b069eb34fa4d365663c0d9d">getSections</a>();
<a name="l00144"></a>00144             <span class="keywordflow">if</span> (piSections)
<a name="l00145"></a>00145             {
<a name="l00146"></a>00146                 <a name="_a66"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_section.html">DWFSection</a>* pSection = NULL;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                 <span class="keywordflow">for</span> (; piSections-&gt;<a name="a67"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest_1_1_section_iterator.html#dac7c210467ca8936aedcaafffb21dee">valid</a>(); piSections-&gt;<a name="a68"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest_1_1_section_iterator.html#664f8784e379383402f73aeb98bca97f">next</a>())
<a name="l00149"></a>00149                 {
<a name="l00150"></a>00150                     pSection = piSections-&gt;<a name="a69"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_manifest_1_1_section_iterator.html#712109514c51d8578a1a5952b71603f1">get</a>();
<a name="l00151"></a>00151                     pSection-&gt;<a name="a70"></a><a class="code" href="class_d_w_f_toolkit_1_1_d_w_f_section.html#ed270ed36326bbe4741acf3fcb39720f">readDescriptor</a>();
<a name="l00152"></a>00152 
<a name="l00153"></a>00153                     <span class="comment">//</span>
<a name="l00154"></a>00154                     <span class="comment">//  Add the section</span>
<a name="l00155"></a>00155                     <span class="comment">//</span>
<a name="l00156"></a>00156                     oWriter.addSection( pSection );
<a name="l00157"></a>00157                 }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159                 <a class="code" href="ansi_2_core_8h.html#ce71efacf1405ba604c380dd9b46ec9a">DWFCORE_FREE_OBJECT</a>( piSections );
<a name="l00160"></a>00160             }
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163         oWriter.write();
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_vector_iterator.html">DWFOrderedVector&lt;DWFPackageReader*&gt;::Iterator</a>* piReader = oReaders.<a name="a71"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_ordered_vector.html#c49f9eff2ae38470827eedc5b90f1eb1">iterator</a>();
<a name="l00166"></a>00166         <span class="keywordflow">if</span> (piReader)
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168             <span class="keywordflow">for</span> (; piReader-&gt;valid(); piReader-&gt;next())
<a name="l00169"></a>00169             {
<a name="l00170"></a>00170                 <a class="code" href="ansi_2_core_8h.html#ce71efacf1405ba604c380dd9b46ec9a">DWFCORE_FREE_OBJECT</a>( piReader-&gt;get() );
<a name="l00171"></a>00171             }
<a name="l00172"></a>00172             <a class="code" href="ansi_2_core_8h.html#ce71efacf1405ba604c380dd9b46ec9a">DWFCORE_FREE_OBJECT</a>( piReader );
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="keywordflow">catch</span> (<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html">DWFException</a>&amp; ex)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179         wcout &lt;&lt; ex.<a name="a72"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html#43b65657deee838003ccb9d45bd278ab">type</a>() &lt;&lt; L<span class="stringliteral">": "</span> &lt;&lt; ex.<a name="a73"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html#c079574388a7104cc5db0a8ae05bc976">message</a>() &lt;&lt; endl;
<a name="l00180"></a>00180         wcout &lt;&lt; L<span class="stringliteral">"(function) "</span> &lt;&lt; ex.<a name="a74"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html#c7f846ae1f20b56661abf324e94ac768">function</a>() &lt;&lt; endl;
<a name="l00181"></a>00181         wcout &lt;&lt; L<span class="stringliteral">"(file) "</span> &lt;&lt; ex.<a name="a75"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html#00b02f89d94206e86a803547abe11ad1">file</a>() &lt;&lt; endl;
<a name="l00182"></a>00182         wcout &lt;&lt; L<span class="stringliteral">"(line) "</span> &lt;&lt; ex.<a name="a76"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_exception.html#ecd49893c4894e5331f43829dc75c67a">line</a>() &lt;&lt; endl;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <span class="keywordflow">return</span> 0;
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="keywordtype">bool</span> processArgs( <span class="keywordtype">int</span> argc, 
<a name="l00191"></a>00191                   <span class="keywordtype">char</span>* argv[], 
<a name="l00192"></a>00192                   std::vector&lt;DWFString&gt;&amp; oInfiles, 
<a name="l00193"></a>00193                   <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html">DWFString</a>&amp; zOutfile, 
<a name="l00194"></a>00194                   DWFPackageWriter::teMergeContent&amp; eMergeType )
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196     zOutfile.<a name="a77"></a><a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html#fe4f395bc11600cad49c02b3c9cbe786">assign</a>( L<span class="stringliteral">"Aggregated.dwf"</span> );
<a name="l00197"></a>00197     eMergeType = DWFPackageWriter::eMergePriorityPrimary;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordtype">int</span> i=1;
<a name="l00200"></a>00200     <span class="keywordflow">while</span> (i &lt; argc)
<a name="l00201"></a>00201     {
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (argv[i][0] == <span class="charliteral">'-'</span>)
<a name="l00203"></a>00203         {
<a name="l00204"></a>00204             <span class="keywordflow">if</span> (argv[i][1] == <span class="charliteral">'o'</span>)
<a name="l00205"></a>00205             {
<a name="l00206"></a>00206                 <span class="keywordflow">if</span> (argc == i+1)
<a name="l00207"></a>00207                 {
<a name="l00208"></a>00208                     wcout &lt;&lt; L<span class="stringliteral">"No output file specified with the -o option"</span> &lt;&lt; endl;
<a name="l00209"></a>00209                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00210"></a>00210                 }
<a name="l00211"></a>00211                 zOutfile.<a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html#fe4f395bc11600cad49c02b3c9cbe786">assign</a>( argv[++i] );
<a name="l00212"></a>00212             }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214             <span class="keywordflow">if</span> (argv[i][1] == <span class="charliteral">'m'</span>)
<a name="l00215"></a>00215             {
<a name="l00216"></a>00216                 <span class="keywordflow">if</span> (argc &gt; i+1)
<a name="l00217"></a>00217                 {
<a name="l00218"></a>00218                     <span class="comment">//</span>
<a name="l00219"></a>00219                     <span class="comment">// Compare whole word - not just character since this may be a file name otherwise</span>
<a name="l00220"></a>00220                     <span class="comment">//</span>
<a name="l00221"></a>00221                     <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html">DWFString</a> zMergeValue( argv[i+1] );
<a name="l00222"></a>00222                     <span class="keywordflow">if</span> (zMergeValue == L<span class="stringliteral">"P"</span> || zMergeValue == L<span class="stringliteral">"p"</span>)
<a name="l00223"></a>00223                     {
<a name="l00224"></a>00224                         eMergeType = DWFPackageWriter::eMergePriorityPrimary;
<a name="l00225"></a>00225                         ++i;
<a name="l00226"></a>00226                     }
<a name="l00227"></a>00227                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (zMergeValue == L<span class="stringliteral">"S"</span> || zMergeValue == L<span class="stringliteral">"s"</span>)
<a name="l00228"></a>00228                     {
<a name="l00229"></a>00229                         eMergeType = DWFPackageWriter::eMergePrioritySecondary;
<a name="l00230"></a>00230                         ++i;
<a name="l00231"></a>00231                     }
<a name="l00232"></a>00232                     <span class="keywordflow">else</span>
<a name="l00233"></a>00233                     {
<a name="l00234"></a>00234                         eMergeType = DWFPackageWriter::eMergePriorityPrimary;
<a name="l00235"></a>00235                     }
<a name="l00236"></a>00236                 }
<a name="l00237"></a>00237                 <span class="keywordflow">else</span>
<a name="l00238"></a>00238                 {
<a name="l00239"></a>00239                     eMergeType = DWFPackageWriter::eMergePriorityPrimary;
<a name="l00240"></a>00240                 }
<a name="l00241"></a>00241             }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <span class="keywordflow">if</span>((argv[i][1] == <span class="charliteral">'h'</span>) ||
<a name="l00244"></a>00244                (argv[i][1] == <span class="charliteral">'?'</span>) ||
<a name="l00245"></a>00245                (argv[i][1] == <span class="charliteral">'-'</span>) &amp;&amp; (argv[i][2] == <span class="charliteral">'h'</span>))
<a name="l00246"></a>00246             {
<a name="l00247"></a>00247                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00248"></a>00248             }
<a name="l00249"></a>00249         }
<a name="l00250"></a>00250         <span class="keywordflow">else</span>
<a name="l00251"></a>00251         {
<a name="l00252"></a>00252             oInfiles.push_back( <a class="codeRef" doxygen="dwfcore.tag:../../../docs/DWF Core/html/" href="../../../docs/DWF Core/html/class_d_w_f_core_1_1_d_w_f_string.html">DWFString</a>(argv[i]) );
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255         i++;
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <span class="keywordflow">if</span> (oInfiles.empty())
<a name="l00259"></a>00259     {
<a name="l00260"></a>00260         wcout &lt;&lt; L<span class="stringliteral">"No input files were provided for aggregation."</span> &lt;&lt; endl;
<a name="l00261"></a>00261         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Tue Jan 6 22:40:01 2009 for Autodesk DWF Toolkit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
